# Workflow 2: Greet a Pull Request
#
# New concepts introduced:
#   - pull_request trigger    â€“ fires when a PR is opened, updated, etc.
#   - Expressions ${{ }}      â€“ embed dynamic values anywhere in the YAML
#   - github context          â€“ built-in data about the event and repo
#   - actions/github-script   â€“ lets you call the GitHub API using JavaScript
#   - permissions block       â€“ grant only the access this workflow needs
#                               (principle of least privilege)

name: 02 Â· Greet on Pull Request

on:
  pull_request:
    types:
      - opened   # fire only when a PR is first opened (not on every push)

# Give this workflow write access to pull-request comments,
# but nothing else.
permissions:
  pull-requests: write

jobs:
  greet:
    runs-on: ubuntu-latest

    steps:
      # Step 1 â€“ log who opened the PR using a GitHub expression
      - name: Show PR author
        run: |
          echo "ğŸ‘¤ PR opened by : ${{ github.actor }}"
          echo "ğŸ“ PR title      : ${{ github.event.pull_request.title }}"
          echo "ğŸ”¢ PR number     : ${{ github.event.pull_request.number }}"

      # Step 2 â€“ post a welcome comment on the PR using the GitHub API.
      # 'actions/github-script' is a popular Action that gives you a
      # pre-authenticated Octokit client inside a JS snippet.
      - name: Post welcome comment
        uses: actions/github-script@v7
        with:
          script: |
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo:  context.repo.repo,
              issue_number: context.issue.number,
              body: `ğŸ‘‹ Thanks for opening this pull request, @${context.actor}!\n\n` +
                    `A maintainer will review it soon. In the meantime, please make sure:\n` +
                    `- [ ] Your changes are described in the PR description\n` +
                    `- [ ] All existing tests still pass\n\n` +
                    `_This comment was posted automatically by a GitHub Actions workflow._`
            });
